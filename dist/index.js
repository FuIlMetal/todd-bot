"use strict";var U=Object.create;var u=Object.defineProperty;var K=Object.getOwnPropertyDescriptor;var L=Object.getOwnPropertyNames;var Y=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var g=(o,e)=>{for(var t in e)u(o,t,{get:e[t],enumerable:!0})},G=(o,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of L(e))!k.call(o,s)&&s!==t&&u(o,s,{get:()=>e[s],enumerable:!(r=K(e,s))||r.enumerable});return o};var C=(o,e,t)=>(t=o!=null?U(Y(o)):{},G(e||!o||!o.__esModule?u(t,"default",{value:o,enumerable:!0}):t,o));var n=require("discord.js");var T={};g(T,{data:()=>z,execute:()=>q});var b=require("discord.js");var S=C(require("dotenv")),y=require("@fightmegg/riot-api");S.default.config();var{DISCORD_TOKEN:R,DISCORD_CLIENT_ID:A,GUILD_ID:P,SUPABASE_URL:E,SUPABASE_KEY:w,RIOT_KEY:F}=process.env,j={debug:!1},D=new y.RiotAPI(String(F),j);console.log(D.account);if(!R||!A||!P||!E||!w)throw new Error("Missing environment variables");var a={DISCORD_TOKEN:R,DISCORD_CLIENT_ID:A,GUILD_ID:P,SUPABASE_URL:E,SUPABASE_KEY:w,rAPI:D};var i=require("@fightmegg/riot-api"),z=new b.SlashCommandBuilder().setName("ping").setDescription("Replies with Pong!");async function q(o){console.log("here");let e=await a.rAPI.tournamentStubV5.createProvider({body:{region:i.RiotAPITypes.TournamentV5.REGION.NA,url:""}});console.log(e);let t=await a.rAPI.tournamentStubV5.createTournament({body:{providerId:e}});console.log(String(t));let r=await a.rAPI.tournamentStubV5.createCodes({params:{count:1,tournamentId:t},body:{teamSize:5,pickType:i.RiotAPITypes.TournamentV5.PICKTYPE.TOURNAMENT_DRAFT,mapType:i.RiotAPITypes.TournamentV5.MAPTYPE.SUMMONERS_RIFT,spectatorType:i.RiotAPITypes.TournamentV5.SPECTATORTYPE.ALL,enoughPlayers:!0}});return console.log(r),o.reply(String(r.pop()))}var I={};g(I,{data:()=>$,execute:()=>f});var x=require("discord.js");var c=require("@fightmegg/riot-api");var _=require("@supabase/supabase-js"),J=process.env.SUPABASE_URL,Q=process.env.SUPABASE_KEY,O=(0,_.createClient)(J,Q);var N=require("drizzle-orm/postgres-js");var m=require("drizzle-orm/pg-core"),v=(0,m.pgTable)("teams",{id:(0,m.serial)("id").primaryKey(),name:(0,m.text)("name"),divsion_id:(0,m.integer)("division_id"),group_id:(0,m.integer)("group_id")});var h=C(require("postgres"));async function W(o,e){let t=(0,h.default)("postgresql://postgres.fxfjuvhcuqivdwmrnqpa:t0YPao$dQJWjRDI1@aws-0-us-east-1.pooler.supabase.com:6543/postgres",{prepare:!1});console.log(t);let r=(0,N.drizzle)(t);console.log(r);let s=await r.select().from(v);return console.log(s),null}async function M(o,e){let t=await W(o,O)}var $=new x.ModalBuilder().setCustomId("codes").setTitle("Tournament Codes");async function f(o,e){return await M(o,e),null;let t=await a.rAPI.tournamentStubV5.createProvider({body:{region:c.RiotAPITypes.TournamentV5.REGION.NA,url:""}});console.log(t);let r=await a.rAPI.tournamentStubV5.createTournament({body:{providerId:t}});console.log(r);let s=await a.rAPI.tournamentStubV5.createCodes({params:{count:1,tournamentId:r},body:{teamSize:5,pickType:c.RiotAPITypes.TournamentV5.PICKTYPE.TOURNAMENT_DRAFT,mapType:c.RiotAPITypes.TournamentV5.MAPTYPE.SUMMONERS_RIFT,spectatorType:c.RiotAPITypes.TournamentV5.SPECTATORTYPE.ALL,enoughPlayers:!1}});return console.log(s),null}var d={ping:T,tournament:I};var l=require("discord.js");var H=Object.values(d).map(o=>o.data),X=new l.REST({version:"10"}).setToken(a.DISCORD_TOKEN);async function V({guildId:o}){try{console.log("Started refreshing application (/) commands."),await X.put(l.Routes.applicationGuildCommands(a.DISCORD_CLIENT_ID,o),{body:H}),console.log("Successfully reloaded application (/) commands.")}catch(e){console.error(e)}}var p=new n.Client({intents:["Guilds","GuildMessages","DirectMessages"]}),Oo=Object.values(d).map(o=>o.data),vo=new n.REST({version:"10"}).setToken(a.DISCORD_TOKEN),No=process.env.DISCORD_TOKEN,ho=process.env.PROVIDER_ID,Mo=process.env.TOURNAMENT_ID,xo=process.env.TOURNAMENT_CODE_ENDPOIN;p.once("ready",()=>{console.log("Discord bot is ready! \u{1F916}")});p.on("guildCreate",async o=>{console.log("here"),await V({guildId:o.id})});p.on(n.Events.InteractionCreate,async o=>{if(o.isChatInputCommand()&&o.commandName==="ping"){let e=new n.ModalBuilder().setCustomId("tournament").setTitle("Tournament Codes"),t=new n.TextInputBuilder().setCustomId("team1").setLabel("First team input").setStyle(n.TextInputStyle.Short),r=new n.TextInputBuilder().setCustomId("team2").setLabel("Second team input").setStyle(n.TextInputStyle.Short),s=new n.ActionRowBuilder().addComponents(t),B=new n.ActionRowBuilder().addComponents(r);e.addComponents(s,B),await o.showModal(e)}});p.on(n.Events.InteractionCreate,async o=>{if(o.isModalSubmit()){console.log(o.customId);{let t=o.fields.getTextInputValue("team1"),r=o.fields.getTextInputValue("team2");console.log({team1:t,team2:r});var e=await f(t,r);console.log(e),o.reply({content:"The first/second/third Code for your series is ```"+e+"```"})}}});p.login(a.DISCORD_TOKEN);
